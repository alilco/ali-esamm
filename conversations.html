<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>بحث عن مستخدم</title>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDkL37i0-pd885YbCBYOkADYQVQINcswhk",
      authDomain: "messengerapp-58f7a.firebaseapp.com",
      databaseURL: "https://messengerapp-58f7a-default-rtdb.firebaseio.com",
      projectId: "messengerapp-58f7a",
      appId: "1:46178168523:web:cba8a71de3d7cc5910f54e"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const searchInput = document.addEventListener("input", (e) => {
      const search = e.target.value.trim();
      const usersRef = ref(db, 'users');

      onValue(usersRef, (snapshot) => {
        const users = snapshot.val();
        const results = document.getElementById("results");
        results.innerHTML = "";

        for (let uid in users) {
          const user = users[uid];
          if (user.username && user.username.includes(search)) {
            const li = document.createElement("li");
            li.textContent = user.username;
            li.onclick = () => {
              window.location.href = `chat.html?uid=${uid}`;
            };
            results.appendChild(li);
          }
        }
      });
    });
  </script>
  <style>
    body { font-family: Tahoma; direction: rtl; padding: 20px; background: #f9f9f9; }
    input { width: 100%; padding: 10px; font-size: 16px; border-radius: 10px; border: 1px solid #ccc; margin-bottom: 20px; }
    ul { list-style: none; padding: 0; }
    li { background: white; padding: 15px; border-radius: 10px; margin-bottom: 10px; cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
  </style>
</head>
<body>
  <h2>ابحث عن مستخدم للمراسلة</h2>
  <input type="text" placeholder="اكتب اسم المستخدم">
  <ul id="results"></ul>
</body>
</html>
